(()=>{"use strict";const t=document.querySelector(".slider");const e=document.getElementById("state"),n=document.getElementById("city");function o(t){n.textContent=t[0],n.style.textTransform="capitalize",e.textContent=t[1],e.style.textTransform="capitalize"}function d(t){let e=0;const n=t[0].dt.slice(0,10);return t.forEach((t=>{n===t.dt.slice(0,10)&&e++})),e}function c(t){let e=t.split(/:| /).join("");const n=e.slice(e.length-2);return e=e.length>7?e.slice(0,2):e.slice(0,1),e+n}function a(t){const e=document.createElement("img");return e.classList.add("weather-icon"),e.src=`https://openweathermap.org/img/wn/${t}@2x.png`,e}const i=document.getElementById("search"),s=document.querySelector("button");function l(){"0px"===window.getComputedStyle(i).getPropertyValue("width")?(i.setAttribute("style","width: 75%; transition: width .5s ease;"),setTimeout((()=>{s.style.display="block"}),500)):(i.removeAttribute("style","width: 75%;"),i.style.transition="width .5s ease",setTimeout((()=>{s.style.display="none"}),100))}async function r(t,e){let n=t[0],i=t[1];console.log(t);const s=await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${n},%20${i}&limit=1&appid=c4404ba7cc6d37e8768e9682ed0c7259`,{mode:"cors"});!async function(t,e,n){let i=t[0].lat,s=t[0].lon;const l=await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${i}&lon=${s}&appid=c4404ba7cc6d37e8768e9682ed0c7259&units=${e}`,{mode:"cors"}),r=await l.json();console.log(r),function(t,e,n){const o=document.getElementById("main-left"),i=t.list[0];document.getElementById("weather-condition").textContent=i.weather[0].description,document.getElementById("temperature").textContent=Math.round(i.main.temp),document.getElementById("low").textContent=e[0],document.getElementById("high").textContent=e[1],o.removeChild(o.lastChild),function(t,e){const n=document.getElementById("main-left"),o=document.createElement("div");o.classList.add("todays-card");const i=document.createElement("div");i.classList.add("hourly-container"),t.slice(0,d(t)).forEach((t=>{i.appendChild(function(t,e){const n=document.createElement("div");n.classList.add("hourly-info");const o=document.createElement("p");o.classList.add("hour"),o.textContent=c(t.dt.slice(11));const d=a(t.weather[0].icon),i=document.createElement("div");i.classList.add("temp-container");const s=document.createElement("p");s.classList.add("hourly-temp"),s.textContent=Math.round(t.main.temp);const l=document.createElement("p");return l.classList.add("hourly-degrees"),l.textContent="metric"===e?"°C":"°F",i.append(s,l),n.append(o,d,i),n}(t,e))})),o.appendChild(i);const s=document.createElement("div");s.classList.add("scroll-box"),s.appendChild(o),n.appendChild(s)}(t.list,n),function(t,e){!function(t,e){let n=1,o=function(t){let e=1,n=t[0].dt.slice(0,10);return t.forEach((t=>{t.dt.slice(0,10)!==n&&(e++,n=t.dt.slice(0,10))})),e}(t),i=0,s=d(t),l=s;const r=document.getElementById("main-right"),m=document.getElementById("card-wrapper");for(m.textContent="";n<=o;){let o=t.slice(i,l);const r=document.createElement("div");r.classList.add("cards",`day${n}`);const u=document.createElement("p");u.classList.add("card-day"),u.textContent=new Intl.DateTimeFormat("en-us",{weekday:"long"}).format(new Date(o[0].dt.slice(0,10))),r.appendChild(u);const p=document.createElement("div");p.classList.add("hourly-container"),o.forEach((t=>{const n=document.createElement("div");n.classList.add("next-day-info");const o=document.createElement("p");o.classList.add("next-day-time"),o.textContent=c(t.dt.slice(11));const d=document.createElement("div");d.classList.add("next-day-temp-container");const i=document.createElement("p");i.classList.add("next-day-temp"),i.textContent=Math.round(t.main.temp);const s=document.createElement("p");s.classList.add("next-day-degrees"),s.textContent="metric"===e?"°C":"°F",d.appendChild(i),d.appendChild(s),n.appendChild(o),n.appendChild(a(t.weather[0].icon)),n.appendChild(d),p.appendChild(n),r.appendChild(p)})),m.appendChild(r),n++,i+=s,i!==t.length&&(s=d(t.slice(i))),l+=s}r.appendChild(m)}(t.slice(d(t)),e)}(t.list,n)}(r,function(t){const e=t.list,n=m(t.list[0].dt).slice(0,10);let o=Math.round(t.list[0].main.temp_min),d=Math.round(t.list[0].main.temp_max);return e.forEach((t=>{let e=m(t.dt).slice(0,10),c=Math.round(t.main.temp_min),a=Math.round(t.main.temp_max);t.dt=m(t.dt),e===n&&(c<=o&&(o=c),a>=d&&(d=a))})),[o,d]}(r),e),o(n)}(await s.json(),e,t)}function m(t){const e=new Date(1e3*t).toLocaleDateString(),n=new Date(1e3*t).toLocaleTimeString();let o="";return o=e.length<10?"0"+e:e,o+`, ${n}`}let u="imperial",p=[];const h=["Brooklyn","New York"];window.onload=t=>{r(h,u)},document.querySelector(".switch").addEventListener("click",(e=>{u=function(){getComputedStyle(document.body).getPropertyValue("--switch-rd");const e=document.querySelector(".switch"),n=document.getElementById("degrees"),o=document.getElementById("high-degrees"),d=document.getElementById("low-degrees");return"0px"===window.getComputedStyle(t).getPropertyValue("left")?(t.setAttribute("style","left: 50%; transition: all .5s ease;"),e.setAttribute("style","background: linear-gradient(225deg, #232e40, #1e2736); box-shadow:  -20px 20px 18px #1d2635, 20px -20px 18px #253043; transition: all .5s ease;"),n.textContent="°C",o.textContent="°C",d.textContent="°C","metric"):(t.setAttribute("style","left: 0; transition: all .5s ease;"),e.removeAttribute("style","background: linear-gradient(225deg, #232e40, #1e2736); box-shadow:  -20px 20px 18px #1d2635, 20px -20px 18px #253043;"),e.style.transition="all .5s ease",n.textContent="°F",o.textContent="°F",d.textContent="°F","imperial")}(),p.length>0?r(p,u):r(h,u)}));const y=document.querySelector("form");y.addEventListener("click",(t=>{if("search-icon"===t.target.id)l();else if("right-arrow"===t.target.id){t.preventDefault(),l();const e=document.getElementById("search").value;p=e.indexOf(",")>=0?e.split(", "):e.split(","),r(p,u),y.reset()}}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eUMsRUFBUXhFLFlBQWMsS0FDdEJ5SCxFQUFXekgsWUFBYyxLQUN6QjBILEVBQVUxSCxZQUFjLEtBQ2pCLFdBRVBSLEVBQU91QyxhQUFhLFFBQVMsc0NBQzdCeUYsRUFBYXRGLGdCQUFnQixRQUFTLHlIQUN0Q3NGLEVBQWF2SCxNQUFNa0MsV0FBYSxlQUNoQ3FDLEVBQVF4RSxZQUFjLEtBQ3RCeUgsRUFBV3pILFlBQWMsS0FDekIwSCxFQUFVMUgsWUFBYyxLQUNqQixXQUVmLENHUlUySCxHQUNMVCxFQUFTakcsT0FBUyxFQUFHb0IsRUFBVTZFLEVBQVU1RSxHQUN2Q0QsRUFBVThFLEVBQWE3RSxFQUFLLElBR25DLE1BQU0sRUFBTzdDLFNBQVNDLGNBQWMsUUFDcEMsRUFBSzRILGlCQUFpQixTQUFVRCxJQUM5QixHQUFvQixnQkFBaEJBLEVBQUVPLE9BQU9DLEdBQXNCbEcsU0FDOUIsR0FBb0IsZ0JBQWhCMEYsRUFBRU8sT0FBT0MsR0FBc0IsQ0FDdENSLEVBQUVTLGlCQUNGbkcsSUFDQSxNQUFNNUIsRUFBWU4sU0FBU0csZUFBZSxVQUFVbUksTUFFbERiLEVBREVuSCxFQUFVaUksUUFBUSxNQUFRLEVBQ2pCakksRUFBVWUsTUFBTSxNQUNiZixFQUFVZSxNQUFNLEtBQ2hDdUIsRUFBVTZFLEVBQVU1RSxHQUVwQixFQUFLMkYsT0FDUCxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2VhdGhlci1hcHAvLi9zcmMvc2xpZGVyLmpzIiwid2VicGFjazovL3dlYXRoZXItYXBwLy4vc3JjL1VJLmpzIiwid2VicGFjazovL3dlYXRoZXItYXBwLy4vc3JjL3NlYXJjaC5qcyIsIndlYnBhY2s6Ly93ZWF0aGVyLWFwcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlclwiKTtcblxuZnVuY3Rpb24gbW92ZVNsaWRlcigpIHtcbiAgICBjb25zdCByYWRpdXMgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLXN3aXRjaC1yZFwiKTtcbiAgICBjb25zdCBzd2l0Y2hTbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN3aXRjaFwiKTtcbiAgICBjb25zdCBkZWdyZWVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZWdyZWVzXCIpO1xuICAgIGNvbnN0IGhpZ2hEZWdyZWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhpZ2gtZGVncmVlc1wiKTtcbiAgICBjb25zdCBsb3dEZWdyZWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvdy1kZWdyZWVzXCIpO1xuICAgIGlmKGNoZWNrRGlyZWN0aW9uKCkgPT09IFwiMHB4XCIpIHtcbiAgICAgICAgc2xpZGVyLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwibGVmdDogNTAlOyB0cmFuc2l0aW9uOiBhbGwgLjVzIGVhc2U7XCIpO1xuICAgICAgICBzd2l0Y2hTbGlkZXIuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMjI1ZGVnLCAjMjMyZTQwLCAjMWUyNzM2KTsgYm94LXNoYWRvdzogIC0yMHB4IDIwcHggMThweCAjMWQyNjM1LCAyMHB4IC0yMHB4IDE4cHggIzI1MzA0MzsgdHJhbnNpdGlvbjogYWxsIC41cyBlYXNlO1wiKTtcbiAgICAgICAgZGVncmVlcy50ZXh0Q29udGVudCA9IFwiwrBDXCI7XG4gICAgICAgIGhpZ2hEZWdyZWUudGV4dENvbnRlbnQgPSBcIsKwQ1wiO1xuICAgICAgICBsb3dEZWdyZWUudGV4dENvbnRlbnQgPSBcIsKwQ1wiO1xuICAgICAgICByZXR1cm4gXCJtZXRyaWNcIjtcbiAgICB9ZWxzZSB7XG4gICAgICAgIHNsaWRlci5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImxlZnQ6IDA7IHRyYW5zaXRpb246IGFsbCAuNXMgZWFzZTtcIik7XG4gICAgICAgIHN3aXRjaFNsaWRlci5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgyMjVkZWcsICMyMzJlNDAsICMxZTI3MzYpOyBib3gtc2hhZG93OiAgLTIwcHggMjBweCAxOHB4ICMxZDI2MzUsIDIwcHggLTIwcHggMThweCAjMjUzMDQzO1wiKTtcbiAgICAgICAgc3dpdGNoU2xpZGVyLnN0eWxlLnRyYW5zaXRpb24gPSBcImFsbCAuNXMgZWFzZVwiO1xuICAgICAgICBkZWdyZWVzLnRleHRDb250ZW50ID0gXCLCsEZcIjtcbiAgICAgICAgaGlnaERlZ3JlZS50ZXh0Q29udGVudCA9IFwiwrBGXCI7XG4gICAgICAgIGxvd0RlZ3JlZS50ZXh0Q29udGVudCA9IFwiwrBGXCI7XG4gICAgICAgIHJldHVybiBcImltcGVyaWFsXCI7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjaGVja0RpcmVjdGlvbigpIHtcbiAgICBjb25zdCBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHNsaWRlcik7XG4gICAgY29uc3QgbGVmdCA9IHN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJsZWZ0XCIpO1xuICAgIHJldHVybiBsZWZ0O1xufVxuXG5leHBvcnQge21vdmVTbGlkZXJ9OyIsImNvbnN0IHN0YXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGF0ZVwiKTtcbmNvbnN0IGNpdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNpdHlcIik7XG5cbmZ1bmN0aW9uIHVwZGF0ZUxvY2F0aW9uKHVzZXJJbnB1dCkge1xuICBjaXR5LnRleHRDb250ZW50ID0gdXNlcklucHV0WzBdO1xuICBjaXR5LnN0eWxlLnRleHRUcmFuc2Zvcm0gPSBcImNhcGl0YWxpemVcIjtcbiAgc3RhdGUudGV4dENvbnRlbnQgPSB1c2VySW5wdXRbMV07XG4gIHN0YXRlLnN0eWxlLnRleHRUcmFuc2Zvcm0gPSBcImNhcGl0YWxpemVcIjtcbn1cblxuZnVuY3Rpb24gdXBkYXRlV2VhdGhlckRhdGEod2VhdGhlckRhdGEsIGhpTG9BcnIsIHVuaXRzKSB7XG4gIGNvbnN0IG1haW5MZWZ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluLWxlZnRcIik7XG4gIGNvbnN0IGN1cnJlbnREYXkgPSB3ZWF0aGVyRGF0YS5saXN0WzBdO1xuICBjb25zdCB3ZWF0aGVyQ29uZGl0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWF0aGVyLWNvbmRpdGlvblwiKTtcbiAgd2VhdGhlckNvbmRpdGlvbi50ZXh0Q29udGVudCA9IGN1cnJlbnREYXkud2VhdGhlclswXS5kZXNjcmlwdGlvbjtcbiAgY29uc3QgdGVtcGVyYXR1cmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRlbXBlcmF0dXJlXCIpO1xuICB0ZW1wZXJhdHVyZS50ZXh0Q29udGVudCA9IE1hdGgucm91bmQoY3VycmVudERheS5tYWluLnRlbXApO1xuICBjb25zdCBsb3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvd1wiKTtcbiAgbG93LnRleHRDb250ZW50ID0gaGlMb0FyclswXTtcbiAgY29uc3QgaGlnaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGlnaFwiKTtcbiAgaGlnaC50ZXh0Q29udGVudCA9IGhpTG9BcnJbMV07XG4gIG1haW5MZWZ0LnJlbW92ZUNoaWxkKG1haW5MZWZ0Lmxhc3RDaGlsZCk7XG4gIHVwZGF0ZUN1cnJlbnREYXlDYXJkKHdlYXRoZXJEYXRhLmxpc3QsIHVuaXRzKTtcbiAgdXBkYXRlTmV4dERheUNhcmRzKHdlYXRoZXJEYXRhLmxpc3QsIHVuaXRzKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ3VycmVudERheUNhcmQod2VhdGhlckFyciwgdW5pdHMpIHtcbiAgY29uc3QgbWFpbkxlZnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1haW4tbGVmdFwiKTtcbiAgY29uc3QgdG9kYXlzQ2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIHRvZGF5c0NhcmQuY2xhc3NMaXN0LmFkZChcInRvZGF5cy1jYXJkXCIpO1xuICBjb25zdCBob3VybHlDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBob3VybHlDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImhvdXJseS1jb250YWluZXJcIik7XG4gIGNvbnN0IHRvZGF5c0RhdGEgPSB3ZWF0aGVyQXJyLnNsaWNlKDAsIGN1cnJlbnREYXRlQ291bnRlcih3ZWF0aGVyQXJyKSk7XG4gIHRvZGF5c0RhdGEuZm9yRWFjaChkYXkgPT4ge1xuICAgIGhvdXJseUNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVIb3VybHlJbmZvKGRheSwgdW5pdHMpKTtcbiAgfSlcbiAgdG9kYXlzQ2FyZC5hcHBlbmRDaGlsZChob3VybHlDb250YWluZXIpO1xuICBjb25zdCBzY3JvbGxCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBzY3JvbGxCb3guY2xhc3NMaXN0LmFkZChcInNjcm9sbC1ib3hcIik7XG4gIHNjcm9sbEJveC5hcHBlbmRDaGlsZCh0b2RheXNDYXJkKTtcbiAgbWFpbkxlZnQuYXBwZW5kQ2hpbGQoc2Nyb2xsQm94KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlSG91cmx5SW5mbyhob3VybHlEYXRhLCB1bml0cykge1xuICBjb25zdCBob3VybHlJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgaG91cmx5SW5mby5jbGFzc0xpc3QuYWRkKFwiaG91cmx5LWluZm9cIik7XG4gIGNvbnN0IGhvdXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgaG91ci5jbGFzc0xpc3QuYWRkKFwiaG91clwiKTtcbiAgaG91ci50ZXh0Q29udGVudCA9IHNpbXBsaWZ5VGltZShob3VybHlEYXRhLmR0LnNsaWNlKDExKSk7XG4gIGNvbnN0IHdlYXRoZXJJY29uID0gY3JlYXRlV2VhdGhlckljb24oaG91cmx5RGF0YS53ZWF0aGVyWzBdLmljb24pO1xuICBjb25zdCB0ZW1wQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgdGVtcENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwidGVtcC1jb250YWluZXJcIik7XG4gIGNvbnN0IGhvdXJseVRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgaG91cmx5VGVtcC5jbGFzc0xpc3QuYWRkKFwiaG91cmx5LXRlbXBcIik7XG4gIGhvdXJseVRlbXAudGV4dENvbnRlbnQgPSBNYXRoLnJvdW5kKGhvdXJseURhdGEubWFpbi50ZW1wKTtcbiAgY29uc3QgZGVncmVlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICBkZWdyZWVzLmNsYXNzTGlzdC5hZGQoXCJob3VybHktZGVncmVlc1wiKTtcbiAgKHVuaXRzID09PSBcIm1ldHJpY1wiKSA/IGRlZ3JlZXMudGV4dENvbnRlbnQgPSBcIsKwQ1wiIDogZGVncmVlcy50ZXh0Q29udGVudCA9IFwiwrBGXCI7XG4gIHRlbXBDb250YWluZXIuYXBwZW5kKGhvdXJseVRlbXAsIGRlZ3JlZXMpO1xuICBob3VybHlJbmZvLmFwcGVuZChob3VyLCB3ZWF0aGVySWNvbiwgdGVtcENvbnRhaW5lcik7XG4gIHJldHVybiBob3VybHlJbmZvO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVOZXh0RGF5Q2FyZHMod2VhdGhlckFyciwgdW5pdHMpIHtcbiAgY29uc3QgbmV4dERheXNBcnIgPSB3ZWF0aGVyQXJyLnNsaWNlKGN1cnJlbnREYXRlQ291bnRlcih3ZWF0aGVyQXJyKSk7XG4gIGNyZWF0ZUNhcmRzKG5leHREYXlzQXJyLCB1bml0cyk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmRzKHdlYXRoZXJBcnIsIHVuaXRzKSB7XG4gIGxldCBjYXJkU3RhcnREYXkgPSAxO1xuICBsZXQgY2FyZEVuZERheSA9IGNhcmRDb3VudCh3ZWF0aGVyQXJyKTtcbiAgbGV0IHN0YXJ0SW5kZXggPSAwO1xuICBsZXQgZW5kSW5kZXggPSBjdXJyZW50RGF0ZUNvdW50ZXIod2VhdGhlckFycik7XG4gIGxldCBlbmRJbmRleENvdW50ID0gZW5kSW5kZXg7XG4gIGNvbnN0IG1haW5SaWdodCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFpbi1yaWdodFwiKTtcbiAgY29uc3QgY2FyZFdyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhcmQtd3JhcHBlclwiKTtcbiAgY2FyZFdyYXBwZXIudGV4dENvbnRlbnQgPSBcIlwiO1xuICB3aGlsZShjYXJkU3RhcnREYXkgPD0gY2FyZEVuZERheSkge1xuICAgIGxldCBzYW1lRGF5QXJyID0gd2VhdGhlckFyci5zbGljZShzdGFydEluZGV4LCBlbmRJbmRleENvdW50KTtcbiAgICBjb25zdCBjYXJkcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY2FyZHMuY2xhc3NMaXN0LmFkZChcImNhcmRzXCIsIGBkYXkke2NhcmRTdGFydERheX1gKTtcbiAgICBjb25zdCBjYWxlbmRhckRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICAgIGNhbGVuZGFyRGF5LmNsYXNzTGlzdC5hZGQoXCJjYXJkLWRheVwiKTtcbiAgICBjYWxlbmRhckRheS50ZXh0Q29udGVudCA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KFwiZW4tdXNcIiwge3dlZWtkYXk6IFwibG9uZ1wifSkuZm9ybWF0KG5ldyBEYXRlKHNhbWVEYXlBcnJbMF0uZHQuc2xpY2UoMCwgMTApKSk7XG4gICAgY2FyZHMuYXBwZW5kQ2hpbGQoY2FsZW5kYXJEYXkpO1xuICAgIGNvbnN0IGhvdXJseUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgaG91cmx5Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJob3VybHktY29udGFpbmVyXCIpO1xuICAgIHNhbWVEYXlBcnIuZm9yRWFjaChkYXkgPT4ge1xuICAgICAgY29uc3QgY2FyZEluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgY2FyZEluZm8uY2xhc3NMaXN0LmFkZChcIm5leHQtZGF5LWluZm9cIilcbiAgICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICAgIHRpbWUuY2xhc3NMaXN0LmFkZChcIm5leHQtZGF5LXRpbWVcIik7XG4gICAgICB0aW1lLnRleHRDb250ZW50ID0gc2ltcGxpZnlUaW1lKGRheS5kdC5zbGljZSgxMSkpO1xuICAgICAgY29uc3QgdGVtcENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICB0ZW1wQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJuZXh0LWRheS10ZW1wLWNvbnRhaW5lclwiKTtcbiAgICAgIGNvbnN0IHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICAgIHRlbXAuY2xhc3NMaXN0LmFkZChcIm5leHQtZGF5LXRlbXBcIik7XG4gICAgICB0ZW1wLnRleHRDb250ZW50ID0gTWF0aC5yb3VuZChkYXkubWFpbi50ZW1wKTtcbiAgICAgIGNvbnN0IGRlZ3JlZXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICAgIGRlZ3JlZXMuY2xhc3NMaXN0LmFkZChcIm5leHQtZGF5LWRlZ3JlZXNcIik7XG4gICAgICBpZih1bml0cyA9PT0gXCJtZXRyaWNcIikgZGVncmVlcy50ZXh0Q29udGVudCA9IFwiwrBDXCI7XG4gICAgICBlbHNlIGRlZ3JlZXMudGV4dENvbnRlbnQgPSBcIsKwRlwiO1xuICAgICAgdGVtcENvbnRhaW5lci5hcHBlbmRDaGlsZCh0ZW1wKTtcbiAgICAgIHRlbXBDb250YWluZXIuYXBwZW5kQ2hpbGQoZGVncmVlcyk7XG4gICAgICBjYXJkSW5mby5hcHBlbmRDaGlsZCh0aW1lKTtcbiAgICAgIGNhcmRJbmZvLmFwcGVuZENoaWxkKGNyZWF0ZVdlYXRoZXJJY29uKGRheS53ZWF0aGVyWzBdLmljb24pKTtcbiAgICAgIGNhcmRJbmZvLmFwcGVuZENoaWxkKHRlbXBDb250YWluZXIpO1xuICAgICAgaG91cmx5Q29udGFpbmVyLmFwcGVuZENoaWxkKGNhcmRJbmZvKTtcbiAgICAgIGNhcmRzLmFwcGVuZENoaWxkKGhvdXJseUNvbnRhaW5lcik7XG4gICAgfSk7XG4gICAgY2FyZFdyYXBwZXIuYXBwZW5kQ2hpbGQoY2FyZHMpO1xuICAgIGNhcmRTdGFydERheSsrO1xuICAgIHN0YXJ0SW5kZXggKz0gZW5kSW5kZXg7XG4gICAgaWYoc3RhcnRJbmRleCAhPT0gd2VhdGhlckFyci5sZW5ndGgpIGVuZEluZGV4ID0gY3VycmVudERhdGVDb3VudGVyKHdlYXRoZXJBcnIuc2xpY2Uoc3RhcnRJbmRleCkpO1xuICAgIGVuZEluZGV4Q291bnQgKz0gZW5kSW5kZXg7XG4gIH1cbiAgbWFpblJpZ2h0LmFwcGVuZENoaWxkKGNhcmRXcmFwcGVyKTsgIFxufVxuXG4vL0NvdW50IGhvdyBtYW55IGRheXMgdW50aWwgbmV4dCBkYXkgZGF0YVxuZnVuY3Rpb24gY3VycmVudERhdGVDb3VudGVyKHdlYXRoZXJBcnIpIHtcbiAgbGV0IGNvdW50ZXIgPSAwO1xuICBjb25zdCB0b2RheXNEYXRlID0gd2VhdGhlckFyclswXS5kdC5zbGljZSgwLCAxMCk7XG4gIHdlYXRoZXJBcnIuZm9yRWFjaCgoZGF0ZSkgPT4ge1xuICAgIGlmICh0b2RheXNEYXRlID09PSBkYXRlLmR0LnNsaWNlKDAsIDEwKSkgY291bnRlcisrO1xuICB9KTtcbiAgcmV0dXJuIGNvdW50ZXI7XG59XG5cbi8vQ291bnQgaG93IG1hbnkgY2FyZCBjb250YWluZXJzIHRvIG1ha2UgYmFzZWQgb24gZGlmZmVyZW50IGRhdGUuXG5mdW5jdGlvbiBjYXJkQ291bnQod2VhdGhlckFycikge1xuICBsZXQgZGF5Q291bnQgPSAxO1xuICBsZXQgZGF0ZSA9IHdlYXRoZXJBcnJbMF0uZHQuc2xpY2UoMCwgMTApO1xuICB3ZWF0aGVyQXJyLmZvckVhY2goZGF5ID0+IHtcbiAgICBpZihkYXkuZHQuc2xpY2UoMCwgMTApICE9PSBkYXRlKSB7XG4gICAgICBkYXlDb3VudCsrO1xuICAgICAgZGF0ZSA9IGRheS5kdC5zbGljZSgwLCAxMCk7XG4gICAgfVxuICB9KVxuICByZXR1cm4gZGF5Q291bnQ7XG59XG5cbmZ1bmN0aW9uIHNpbXBsaWZ5VGltZShzdHIpIHtcbiAgbGV0IHJlc3VsdCA9IHN0ci5zcGxpdCgvOnwgLykuam9pbihcIlwiKTtcbiAgY29uc3QgcGVyaW9kID0gcmVzdWx0LnNsaWNlKHJlc3VsdC5sZW5ndGggLSAyKTtcbiAgKHJlc3VsdC5sZW5ndGggPiA3KSA/IHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLCAyKSA6IHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLCAxKTtcbiAgcmV0dXJuIHJlc3VsdCArIHBlcmlvZDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlV2VhdGhlckljb24oZGVzY3JpcHRpb24pIHtcbiAgY29uc3Qgd2VhdGhlckljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICB3ZWF0aGVySWNvbi5jbGFzc0xpc3QuYWRkKFwid2VhdGhlci1pY29uXCIpO1xuICB3ZWF0aGVySWNvbi5zcmMgPSBgaHR0cHM6Ly9vcGVud2VhdGhlcm1hcC5vcmcvaW1nL3duLyR7ZGVzY3JpcHRpb259QDJ4LnBuZ2A7XG4gIHJldHVybiB3ZWF0aGVySWNvbjtcbn1cblxuZXhwb3J0IHsgdXBkYXRlTG9jYXRpb24sIHVwZGF0ZVdlYXRoZXJEYXRhIH07XG4iLCJpbXBvcnQgeyB1cGRhdGVXZWF0aGVyRGF0YSwgdXBkYXRlTG9jYXRpb24gfSBmcm9tIFwiLi9VSVwiO1xuXG5jb25zdCBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoXCIpO1xuY29uc3QgZW50ZXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uXCIpO1xuXG5mdW5jdGlvbiBhbmltYXRlU2VhcmNoQmFyKCkge1xuICBjb25zdCBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGlucHV0KTtcbiAgY29uc3Qgd2lkdGggPSBzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwid2lkdGhcIik7XG4gIGlmICh3aWR0aCA9PT0gXCIwcHhcIikge1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwid2lkdGg6IDc1JTsgdHJhbnNpdGlvbjogd2lkdGggLjVzIGVhc2U7XCIpO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZW50ZXJCdG4uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICB9LCA1MDApO1xuICB9IGVsc2Uge1xuICAgIGlucHV0LnJlbW92ZUF0dHJpYnV0ZShcInN0eWxlXCIsIFwid2lkdGg6IDc1JTtcIik7XG4gICAgaW5wdXQuc3R5bGUudHJhbnNpdGlvbiA9IFwid2lkdGggLjVzIGVhc2VcIjtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGVudGVyQnRuLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICB9LCAxMDApO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNlYXJjaEJhcih1c2VySW5wdXQsIHVuaXRzKSB7XG4gIGxldCBjaXR5ID0gdXNlcklucHV0WzBdO1xuICBsZXQgc3RhdGUgPSB1c2VySW5wdXRbMV07XG4gIGNvbnNvbGUubG9nKHVzZXJJbnB1dCk7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgYGh0dHBzOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9nZW8vMS4wL2RpcmVjdD9xPSR7Y2l0eX0sJTIwJHtzdGF0ZX0mbGltaXQ9MSZhcHBpZD1jNDQwNGJhN2NjNmQzN2U4NzY4ZTk2ODJlZDBjNzI1OWAsXG4gICAgeyBtb2RlOiBcImNvcnNcIiB9XG4gICk7XG4gIGNvbnN0IGxvY2F0aW9uRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgY29udmVydFRvQ29yZGluYXRlcyhsb2NhdGlvbkRhdGEsIHVuaXRzLCB1c2VySW5wdXQpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBjb252ZXJ0VG9Db3JkaW5hdGVzKGRhdGEsIHVuaXRzLCB1c2VySW5wdXQpIHtcbiAgbGV0IGxhdCA9IGRhdGFbMF0ubGF0O1xuICBsZXQgbG9uID0gZGF0YVswXS5sb247XG4gIGNvbnN0IGNvcmRpbmF0ZVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgYGh0dHBzOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS9mb3JlY2FzdD9sYXQ9JHtsYXR9Jmxvbj0ke2xvbn0mYXBwaWQ9YzQ0MDRiYTdjYzZkMzdlODc2OGU5NjgyZWQwYzcyNTkmdW5pdHM9JHt1bml0c31gLFxuICAgIHsgbW9kZTogXCJjb3JzXCIgfVxuICApO1xuICBjb25zdCBjb3JkaW5hdGVEYXRhID0gYXdhaXQgY29yZGluYXRlUmVzcG9uc2UuanNvbigpO1xuICBjb25zb2xlLmxvZyhjb3JkaW5hdGVEYXRhKTtcbiAgdXBkYXRlV2VhdGhlckRhdGEoY29yZGluYXRlRGF0YSwgZ2V0Q3VycmVudEhpTG8oY29yZGluYXRlRGF0YSksIHVuaXRzKTtcbiAgdXBkYXRlTG9jYXRpb24odXNlcklucHV0KTtcbiAgcmV0dXJuIGNvcmRpbmF0ZURhdGE7XG59XG5cbmZ1bmN0aW9uIGdldEN1cnJlbnRIaUxvKHdlYXRoZXJEYXRhKSB7XG4gIGNvbnN0IHdlYXRoZXJBcnIgPSB3ZWF0aGVyRGF0YS5saXN0O1xuICBjb25zdCB0b2RheXNEYXRlID0gY29udmVydFVuaXhUb1VUQyh3ZWF0aGVyRGF0YS5saXN0WzBdLmR0KS5zbGljZSgwLCAxMCk7XG4gIGxldCBsb3cgPSBNYXRoLnJvdW5kKHdlYXRoZXJEYXRhLmxpc3RbMF0ubWFpbi50ZW1wX21pbik7XG4gIGxldCBoaWdoID0gTWF0aC5yb3VuZCh3ZWF0aGVyRGF0YS5saXN0WzBdLm1haW4udGVtcF9tYXgpO1xuICB3ZWF0aGVyQXJyLmZvckVhY2goKGRheSkgPT4ge1xuICAgIGxldCBpZlRvZGF5c0RhdGUgPSBjb252ZXJ0VW5peFRvVVRDKGRheS5kdCkuc2xpY2UoMCwgMTApO1xuICAgIGxldCBtaW5UZW1wID0gTWF0aC5yb3VuZChkYXkubWFpbi50ZW1wX21pbik7XG4gICAgbGV0IG1heFRlbXAgPSBNYXRoLnJvdW5kKGRheS5tYWluLnRlbXBfbWF4KTtcbiAgICBkYXkuZHQgPSBjb252ZXJ0VW5peFRvVVRDKGRheS5kdCk7XG4gICAgaWYgKGlmVG9kYXlzRGF0ZSA9PT0gdG9kYXlzRGF0ZSkge1xuICAgICAgaWYobWluVGVtcCA8PSBsb3cpIGxvdyA9IG1pblRlbXA7XG4gICAgICBpZihtYXhUZW1wID49IGhpZ2gpIGhpZ2ggPSBtYXhUZW1wO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBbbG93LCBoaWdoXTtcbn1cblxuZnVuY3Rpb24gY29udmVydFVuaXhUb1VUQyh1bml4VGltZSkge1xuICBjb25zdCBjb252ZXJ0ZWREYXRlID0gbmV3IERhdGUodW5peFRpbWUgKiAxMDAwKS50b0xvY2FsZURhdGVTdHJpbmcoKTtcbiAgY29uc3QgY29udmVydGVkVGltZSA9IG5ldyBEYXRlKHVuaXhUaW1lICogMTAwMCkudG9Mb2NhbGVUaW1lU3RyaW5nKCk7XG4gIGxldCByZXN1bHQgPSBcIlwiO1xuICAoY29udmVydGVkRGF0ZS5sZW5ndGggPCAxMCkgPyByZXN1bHQgPSAoXCIwXCIgKyBjb252ZXJ0ZWREYXRlKSA6IHJlc3VsdCA9IGNvbnZlcnRlZERhdGU7XG4gIHJldHVybiByZXN1bHQgKz0gYCwgJHtjb252ZXJ0ZWRUaW1lfWA7XG59XG5cbmV4cG9ydCB7IGFuaW1hdGVTZWFyY2hCYXIsIHNlYXJjaEJhciB9O1xuIiwiaW1wb3J0IHsgbW92ZVNsaWRlciB9IGZyb20gXCIuL3NsaWRlclwiO1xuaW1wb3J0IHsgYW5pbWF0ZVNlYXJjaEJhciwgc2VhcmNoQmFyIH0gZnJvbSBcIi4vc2VhcmNoXCI7XG5pbXBvcnQgeyB1cGRhdGVMb2NhdGlvbiB9IGZyb20gXCIuL1VJXCI7XG5cbmxldCB1bml0cyA9IFwiaW1wZXJpYWxcIjtcbmxldCBpbnB1dEFyciA9IFtdO1xuY29uc3Qgb25Mb2FkSW5wdXQgPSBbXCJCcm9va2x5blwiLCBcIk5ldyBZb3JrXCJdO1xuXG5cbndpbmRvdy5vbmxvYWQgPSAoZSkgPT4ge1xuICBzZWFyY2hCYXIob25Mb2FkSW5wdXQsIHVuaXRzKTtcbiAgLy8gdXBkYXRlTG9jYXRpb24oW1wiQnJvb2tseW5cIiwgXCJOZXcgWW9ya1wiXSk7XG59XG5cbmNvbnN0IHNsaWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN3aXRjaFwiKTtcbnNsaWRlcnMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIHVuaXRzID0gbW92ZVNsaWRlcigpO1xuICBpZihpbnB1dEFyci5sZW5ndGggPiAwKSBzZWFyY2hCYXIoaW5wdXRBcnIsIHVuaXRzKTtcbiAgZWxzZSBzZWFyY2hCYXIob25Mb2FkSW5wdXQsIHVuaXRzKVxufSk7XG5cbmNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGlmIChlLnRhcmdldC5pZCA9PT0gXCJzZWFyY2gtaWNvblwiKSBhbmltYXRlU2VhcmNoQmFyKCk7XG4gIGVsc2UgaWYgKGUudGFyZ2V0LmlkID09PSBcInJpZ2h0LWFycm93XCIpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgYW5pbWF0ZVNlYXJjaEJhcigpO1xuICAgIGNvbnN0IHVzZXJJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoXCIpLnZhbHVlO1xuICAgIGlmICh1c2VySW5wdXQuaW5kZXhPZihcIixcIikgPj0gMClcbiAgICAgIGlucHV0QXJyID0gdXNlcklucHV0LnNwbGl0KFwiLCBcIik7IC8vY2hlY2sgZm9yIHdoaXRlc3BhY2VcbiAgICBlbHNlIGlucHV0QXJyID0gdXNlcklucHV0LnNwbGl0KFwiLFwiKTtcbiAgICBzZWFyY2hCYXIoaW5wdXRBcnIsIHVuaXRzKTtcbiAgICAvLyB1cGRhdGVMb2NhdGlvbihpbnB1dEFycik7XG4gICAgZm9ybS5yZXNldCgpO1xuICB9XG59KTtcbiJdLCJuYW1lcyI6WyJzbGlkZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzdGF0ZSIsImdldEVsZW1lbnRCeUlkIiwiY2l0eSIsInVwZGF0ZUxvY2F0aW9uIiwidXNlcklucHV0IiwidGV4dENvbnRlbnQiLCJzdHlsZSIsInRleHRUcmFuc2Zvcm0iLCJjdXJyZW50RGF0ZUNvdW50ZXIiLCJ3ZWF0aGVyQXJyIiwiY291bnRlciIsInRvZGF5c0RhdGUiLCJkdCIsInNsaWNlIiwiZm9yRWFjaCIsImRhdGUiLCJzaW1wbGlmeVRpbWUiLCJzdHIiLCJyZXN1bHQiLCJzcGxpdCIsImpvaW4iLCJwZXJpb2QiLCJsZW5ndGgiLCJjcmVhdGVXZWF0aGVySWNvbiIsImRlc2NyaXB0aW9uIiwid2VhdGhlckljb24iLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic3JjIiwiaW5wdXQiLCJlbnRlckJ0biIsImFuaW1hdGVTZWFyY2hCYXIiLCJ3aW5kb3ciLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInNldEF0dHJpYnV0ZSIsInNldFRpbWVvdXQiLCJkaXNwbGF5IiwicmVtb3ZlQXR0cmlidXRlIiwidHJhbnNpdGlvbiIsImFzeW5jIiwic2VhcmNoQmFyIiwidW5pdHMiLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1vZGUiLCJkYXRhIiwibGF0IiwibG9uIiwiY29yZGluYXRlUmVzcG9uc2UiLCJjb3JkaW5hdGVEYXRhIiwianNvbiIsIndlYXRoZXJEYXRhIiwiaGlMb0FyciIsIm1haW5MZWZ0IiwiY3VycmVudERheSIsImxpc3QiLCJ3ZWF0aGVyIiwiTWF0aCIsInJvdW5kIiwibWFpbiIsInRlbXAiLCJyZW1vdmVDaGlsZCIsImxhc3RDaGlsZCIsInRvZGF5c0NhcmQiLCJob3VybHlDb250YWluZXIiLCJkYXkiLCJhcHBlbmRDaGlsZCIsImhvdXJseURhdGEiLCJob3VybHlJbmZvIiwiaG91ciIsImljb24iLCJ0ZW1wQ29udGFpbmVyIiwiaG91cmx5VGVtcCIsImRlZ3JlZXMiLCJhcHBlbmQiLCJjcmVhdGVIb3VybHlJbmZvIiwic2Nyb2xsQm94IiwidXBkYXRlQ3VycmVudERheUNhcmQiLCJjYXJkU3RhcnREYXkiLCJjYXJkRW5kRGF5IiwiZGF5Q291bnQiLCJjYXJkQ291bnQiLCJzdGFydEluZGV4IiwiZW5kSW5kZXgiLCJlbmRJbmRleENvdW50IiwibWFpblJpZ2h0IiwiY2FyZFdyYXBwZXIiLCJzYW1lRGF5QXJyIiwiY2FyZHMiLCJjYWxlbmRhckRheSIsIkludGwiLCJEYXRlVGltZUZvcm1hdCIsIndlZWtkYXkiLCJmb3JtYXQiLCJEYXRlIiwiY2FyZEluZm8iLCJ0aW1lIiwiY3JlYXRlQ2FyZHMiLCJ1cGRhdGVOZXh0RGF5Q2FyZHMiLCJ1cGRhdGVXZWF0aGVyRGF0YSIsImNvbnZlcnRVbml4VG9VVEMiLCJsb3ciLCJ0ZW1wX21pbiIsImhpZ2giLCJ0ZW1wX21heCIsImlmVG9kYXlzRGF0ZSIsIm1pblRlbXAiLCJtYXhUZW1wIiwiZ2V0Q3VycmVudEhpTG8iLCJjb252ZXJ0VG9Db3JkaW5hdGVzIiwidW5peFRpbWUiLCJjb252ZXJ0ZWREYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiY29udmVydGVkVGltZSIsInRvTG9jYWxlVGltZVN0cmluZyIsImlucHV0QXJyIiwib25Mb2FkSW5wdXQiLCJvbmxvYWQiLCJlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImJvZHkiLCJzd2l0Y2hTbGlkZXIiLCJoaWdoRGVncmVlIiwibG93RGVncmVlIiwibW92ZVNsaWRlciIsInRhcmdldCIsImlkIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsImluZGV4T2YiLCJyZXNldCJdLCJzb3VyY2VSb290IjoiIn0=