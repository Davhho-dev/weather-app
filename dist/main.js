(()=>{"use strict";const t=document.querySelector(".slider");const e=document.getElementById("state"),n=document.getElementById("city");function o(t){n.textContent=t[0],n.style.textTransform="capitalize",e.textContent=t[1],e.style.textTransform="capitalize"}function a(t,e){const n=document.createElement("div");n.classList.add("hourly-info");const o=document.createElement("p");o.classList.add("hour"),o.textContent=function(t){let e=t.split(/:| /).join("");const n=e.slice(e.length-2);return e=e.length>7?e.slice(0,2):e.slice(0,1),e+n}(t.dt.slice(11));const a=function(t){const e=document.createElement("img");return e.classList.add("weather-icon"),e.src=`https://openweathermap.org/img/wn/${t}@2x.png`,e}(t.weather[0].icon),c=document.createElement("div");c.classList.add("temp-container");const d=document.createElement("p");d.classList.add("hourly-temp"),d.textContent=Math.round(t.main.temp);const i=document.createElement("p");return i.classList.add("hourly-degrees"),i.textContent="metric"===e?"°C":"°F",c.append(d,i),n.append(o,a,c),n}function c(t){let e=0;const n=t[0].dt.slice(0,10);return t.forEach((t=>{n===t.dt.slice(0,10)&&e++})),e}const d=document.getElementById("search"),i=document.querySelector("button");function s(){"0px"===window.getComputedStyle(d).getPropertyValue("width")?(d.setAttribute("style","width: 75%; transition: width .5s ease;"),setTimeout((()=>{i.style.display="block"}),500)):(d.removeAttribute("style","width: 75%;"),d.style.transition="width .5s ease",setTimeout((()=>{i.style.display="none"}),100))}async function l(t,e){let n=t[0],d=t[1];const i=await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${n},%20${d}&limit=5&appid=c4404ba7cc6d37e8768e9682ed0c7259`,{mode:"cors"}),s=await i.json();console.log(s),async function(t,e,n){let d=t[0].lat,i=t[0].lon;const s=await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${d}&lon=${i}&appid=c4404ba7cc6d37e8768e9682ed0c7259&units=${e}`,{mode:"cors"}),l=await s.json();console.log(l),function(t,e,n){const o=document.getElementById("main-left"),d=t.list[0];document.getElementById("weather-condition").textContent=d.weather[0].description,document.getElementById("temperature").textContent=Math.round(d.main.temp),document.getElementById("low").textContent=e[0],document.getElementById("high").textContent=e[1],o.removeChild(o.lastChild),function(t,e){const n=document.getElementById("main-left"),o=document.createElement("div");o.classList.add("todays-card");const d=document.createElement("div");d.classList.add("hourly-container"),t.slice(0,c(t)).forEach((t=>{d.appendChild(a(t,e))})),o.appendChild(d);const i=document.createElement("div");i.classList.add("scroll-box"),i.appendChild(o),n.appendChild(i)}(t.list,n),function(t,e){!function(t,e){let n=1,o=function(t){let e=1,n=t[0].dt.slice(0,10);return t.forEach((t=>{t.dt.slice(0,10)!==n&&(e++,n=t.dt.slice(0,10))})),e}(t),d=0,i=c(t),s=i;const l=document.getElementById("main-right"),r=document.getElementById("card-wrapper");for(r.textContent="";n<=o;){let o=t.slice(d,s);const l=document.createElement("div");l.classList.add("cards",`day${n}`);const m=document.createElement("p");m.classList.add("card-day"),m.textContent=new Intl.DateTimeFormat("en-us",{weekday:"short"}).format(new Date(o[0].dt.slice(0,10)));const u=document.createElement("div");u.classList.add("hourly-container"),o.forEach((t=>{u.appendChild(a(t,e))})),l.append(m,u),r.appendChild(l),n++,d+=i,d!==t.length&&(i=c(t.slice(d))),s+=i}l.appendChild(r)}(t.slice(c(t)),e)}(t.list,n)}(l,function(t){const e=t.list,n=r(t.list[0].dt).slice(0,10);let o=Math.round(t.list[0].main.temp_min),a=Math.round(t.list[0].main.temp_max);return e.forEach((t=>{let e=r(t.dt).slice(0,10),c=Math.round(t.main.temp_min),d=Math.round(t.main.temp_max);t.dt=r(t.dt),e===n&&(c<=o&&(o=c),d>=a&&(a=d))})),[o,a]}(l),e),o(n)}(s,e,t)}function r(t){const e=new Date(1e3*t).toLocaleDateString(),n=new Date(1e3*t).toLocaleTimeString();let o="";return o=e.length<10?"0"+e:e,o+`, ${n}`}let m="imperial",u=[];const p=["Brooklyn","New York"];window.onload=t=>{l(p,m)},document.querySelector(".switch").addEventListener("click",(e=>{m=function(){getComputedStyle(document.body).getPropertyValue("--switch-rd");const e=document.querySelector(".switch"),n=document.getElementById("degrees"),o=document.getElementById("high-degrees"),a=document.getElementById("low-degrees");return"0px"===window.getComputedStyle(t).getPropertyValue("left")?(t.setAttribute("style","left: 50%; transition: all .5s ease;"),e.setAttribute("style","background: linear-gradient(225deg, #232e40, #1e2736); box-shadow:  -20px 20px 18px #1d2635, 20px -20px 18px #253043; transition: all .5s ease;"),n.textContent="°C",o.textContent="°C",a.textContent="°C","metric"):(t.setAttribute("style","left: 0; transition: all .5s ease;"),e.removeAttribute("style","background: linear-gradient(225deg, #232e40, #1e2736); box-shadow:  -20px 20px 18px #1d2635, 20px -20px 18px #253043;"),e.style.transition="all .5s ease",n.textContent="°F",o.textContent="°F",a.textContent="°F","imperial")}(),u.length>0?l(u,m):l(p,m)}));const h=document.querySelector("form");h.addEventListener("click",(t=>{if("search-icon"===t.target.id)s();else if("right-arrow"===t.target.id){t.preventDefault(),s();const e=document.getElementById("search").value,n=e.indexOf(",");u=" "===e.charAt(n+1)?e.split(", "):e.split(","),console.log(u),""===u[0]?alert("Please enter a City and State/Country, separated by a comma."):void 0===u[1]?alert("No State/Country was included. Please enter a City and State/Country, separated by a comma."):l(u,m),h.reset()}}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUJoSSxFQUFVYyxNQUFNLE1BQ3ZEZCxFQUFVYyxNQUFNLEtBQ2hDNkMsUUFBUUMsSUFBSXNELEdBQ08sS0FBaEJBLEVBQVMsR0FBV2lCLE1BQU0scUVBQ0xDLElBQWhCbEIsRUFBUyxHQUFrQmlCLE1BQU0sK0ZBRXZDOUUsRUFBVTZELEVBQVU1RyxHQUV0QixFQUFLK0gsT0FDUCxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2VhdGhlci1hcHAvLi9zcmMvc2xpZGVyLmpzIiwid2VicGFjazovL3dlYXRoZXItYXBwLy4vc3JjL1VJLmpzIiwid2VicGFjazovL3dlYXRoZXItYXBwLy4vc3JjL3NlYXJjaC5qcyIsIndlYnBhY2s6Ly93ZWF0aGVyLWFwcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlclwiKTtcblxuZnVuY3Rpb24gbW92ZVNsaWRlcigpIHtcbiAgICBjb25zdCByYWRpdXMgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLXN3aXRjaC1yZFwiKTtcbiAgICBjb25zdCBzd2l0Y2hTbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN3aXRjaFwiKTtcbiAgICBjb25zdCBkZWdyZWVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZWdyZWVzXCIpO1xuICAgIGNvbnN0IGhpZ2hEZWdyZWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhpZ2gtZGVncmVlc1wiKTtcbiAgICBjb25zdCBsb3dEZWdyZWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvdy1kZWdyZWVzXCIpO1xuICAgIGlmKGNoZWNrRGlyZWN0aW9uKCkgPT09IFwiMHB4XCIpIHtcbiAgICAgICAgc2xpZGVyLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwibGVmdDogNTAlOyB0cmFuc2l0aW9uOiBhbGwgLjVzIGVhc2U7XCIpO1xuICAgICAgICBzd2l0Y2hTbGlkZXIuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMjI1ZGVnLCAjMjMyZTQwLCAjMWUyNzM2KTsgYm94LXNoYWRvdzogIC0yMHB4IDIwcHggMThweCAjMWQyNjM1LCAyMHB4IC0yMHB4IDE4cHggIzI1MzA0MzsgdHJhbnNpdGlvbjogYWxsIC41cyBlYXNlO1wiKTtcbiAgICAgICAgZGVncmVlcy50ZXh0Q29udGVudCA9IFwiwrBDXCI7XG4gICAgICAgIGhpZ2hEZWdyZWUudGV4dENvbnRlbnQgPSBcIsKwQ1wiO1xuICAgICAgICBsb3dEZWdyZWUudGV4dENvbnRlbnQgPSBcIsKwQ1wiO1xuICAgICAgICByZXR1cm4gXCJtZXRyaWNcIjtcbiAgICB9ZWxzZSB7XG4gICAgICAgIHNsaWRlci5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImxlZnQ6IDA7IHRyYW5zaXRpb246IGFsbCAuNXMgZWFzZTtcIik7XG4gICAgICAgIHN3aXRjaFNsaWRlci5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgyMjVkZWcsICMyMzJlNDAsICMxZTI3MzYpOyBib3gtc2hhZG93OiAgLTIwcHggMjBweCAxOHB4ICMxZDI2MzUsIDIwcHggLTIwcHggMThweCAjMjUzMDQzO1wiKTtcbiAgICAgICAgc3dpdGNoU2xpZGVyLnN0eWxlLnRyYW5zaXRpb24gPSBcImFsbCAuNXMgZWFzZVwiO1xuICAgICAgICBkZWdyZWVzLnRleHRDb250ZW50ID0gXCLCsEZcIjtcbiAgICAgICAgaGlnaERlZ3JlZS50ZXh0Q29udGVudCA9IFwiwrBGXCI7XG4gICAgICAgIGxvd0RlZ3JlZS50ZXh0Q29udGVudCA9IFwiwrBGXCI7XG4gICAgICAgIHJldHVybiBcImltcGVyaWFsXCI7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjaGVja0RpcmVjdGlvbigpIHtcbiAgICBjb25zdCBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHNsaWRlcik7XG4gICAgY29uc3QgbGVmdCA9IHN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJsZWZ0XCIpO1xuICAgIHJldHVybiBsZWZ0O1xufVxuXG5leHBvcnQge21vdmVTbGlkZXJ9OyIsImNvbnN0IHN0YXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGF0ZVwiKTtcbmNvbnN0IGNpdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNpdHlcIik7XG5cbmZ1bmN0aW9uIHVwZGF0ZUxvY2F0aW9uKHVzZXJJbnB1dCkge1xuICBjaXR5LnRleHRDb250ZW50ID0gdXNlcklucHV0WzBdO1xuICBjaXR5LnN0eWxlLnRleHRUcmFuc2Zvcm0gPSBcImNhcGl0YWxpemVcIjtcbiAgc3RhdGUudGV4dENvbnRlbnQgPSB1c2VySW5wdXRbMV07XG4gIHN0YXRlLnN0eWxlLnRleHRUcmFuc2Zvcm0gPSBcImNhcGl0YWxpemVcIjtcbn1cblxuZnVuY3Rpb24gdXBkYXRlV2VhdGhlckRhdGEod2VhdGhlckRhdGEsIGhpTG9BcnIsIHVuaXRzKSB7XG4gIGNvbnN0IG1haW5MZWZ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluLWxlZnRcIik7XG4gIGNvbnN0IGN1cnJlbnREYXkgPSB3ZWF0aGVyRGF0YS5saXN0WzBdO1xuICBjb25zdCB3ZWF0aGVyQ29uZGl0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3ZWF0aGVyLWNvbmRpdGlvblwiKTtcbiAgd2VhdGhlckNvbmRpdGlvbi50ZXh0Q29udGVudCA9IGN1cnJlbnREYXkud2VhdGhlclswXS5kZXNjcmlwdGlvbjtcbiAgY29uc3QgdGVtcGVyYXR1cmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRlbXBlcmF0dXJlXCIpO1xuICB0ZW1wZXJhdHVyZS50ZXh0Q29udGVudCA9IE1hdGgucm91bmQoY3VycmVudERheS5tYWluLnRlbXApO1xuICBjb25zdCBsb3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvd1wiKTtcbiAgbG93LnRleHRDb250ZW50ID0gaGlMb0FyclswXTtcbiAgY29uc3QgaGlnaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGlnaFwiKTtcbiAgaGlnaC50ZXh0Q29udGVudCA9IGhpTG9BcnJbMV07XG4gIG1haW5MZWZ0LnJlbW92ZUNoaWxkKG1haW5MZWZ0Lmxhc3RDaGlsZCk7XG4gIHVwZGF0ZUN1cnJlbnREYXlDYXJkKHdlYXRoZXJEYXRhLmxpc3QsIHVuaXRzKTtcbiAgdXBkYXRlTmV4dERheUNhcmRzKHdlYXRoZXJEYXRhLmxpc3QsIHVuaXRzKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ3VycmVudERheUNhcmQod2VhdGhlckFyciwgdW5pdHMpIHtcbiAgY29uc3QgbWFpbkxlZnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1haW4tbGVmdFwiKTtcbiAgY29uc3QgdG9kYXlzQ2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIHRvZGF5c0NhcmQuY2xhc3NMaXN0LmFkZChcInRvZGF5cy1jYXJkXCIpO1xuICBjb25zdCBob3VybHlDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBob3VybHlDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImhvdXJseS1jb250YWluZXJcIik7XG4gIGNvbnN0IHRvZGF5c0RhdGEgPSB3ZWF0aGVyQXJyLnNsaWNlKDAsIGN1cnJlbnREYXRlQ291bnRlcih3ZWF0aGVyQXJyKSk7XG4gIHRvZGF5c0RhdGEuZm9yRWFjaChkYXkgPT4ge1xuICAgIGhvdXJseUNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVIb3VybHlJbmZvKGRheSwgdW5pdHMpKTtcbiAgfSlcbiAgdG9kYXlzQ2FyZC5hcHBlbmRDaGlsZChob3VybHlDb250YWluZXIpO1xuICBjb25zdCBzY3JvbGxCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBzY3JvbGxCb3guY2xhc3NMaXN0LmFkZChcInNjcm9sbC1ib3hcIik7XG4gIHNjcm9sbEJveC5hcHBlbmRDaGlsZCh0b2RheXNDYXJkKTtcbiAgbWFpbkxlZnQuYXBwZW5kQ2hpbGQoc2Nyb2xsQm94KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlSG91cmx5SW5mbyhob3VybHlEYXRhLCB1bml0cykge1xuICBjb25zdCBob3VybHlJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgaG91cmx5SW5mby5jbGFzc0xpc3QuYWRkKFwiaG91cmx5LWluZm9cIik7XG4gIGNvbnN0IGhvdXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgaG91ci5jbGFzc0xpc3QuYWRkKFwiaG91clwiKTtcbiAgaG91ci50ZXh0Q29udGVudCA9IHNpbXBsaWZ5VGltZShob3VybHlEYXRhLmR0LnNsaWNlKDExKSk7XG4gIGNvbnN0IHdlYXRoZXJJY29uID0gY3JlYXRlV2VhdGhlckljb24oaG91cmx5RGF0YS53ZWF0aGVyWzBdLmljb24pO1xuICBjb25zdCB0ZW1wQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgdGVtcENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwidGVtcC1jb250YWluZXJcIik7XG4gIGNvbnN0IGhvdXJseVRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgaG91cmx5VGVtcC5jbGFzc0xpc3QuYWRkKFwiaG91cmx5LXRlbXBcIik7XG4gIGhvdXJseVRlbXAudGV4dENvbnRlbnQgPSBNYXRoLnJvdW5kKGhvdXJseURhdGEubWFpbi50ZW1wKTtcbiAgY29uc3QgZGVncmVlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICBkZWdyZWVzLmNsYXNzTGlzdC5hZGQoXCJob3VybHktZGVncmVlc1wiKTtcbiAgKHVuaXRzID09PSBcIm1ldHJpY1wiKSA/IGRlZ3JlZXMudGV4dENvbnRlbnQgPSBcIsKwQ1wiIDogZGVncmVlcy50ZXh0Q29udGVudCA9IFwiwrBGXCI7XG4gIHRlbXBDb250YWluZXIuYXBwZW5kKGhvdXJseVRlbXAsIGRlZ3JlZXMpO1xuICBob3VybHlJbmZvLmFwcGVuZChob3VyLCB3ZWF0aGVySWNvbiwgdGVtcENvbnRhaW5lcik7XG4gIHJldHVybiBob3VybHlJbmZvO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVOZXh0RGF5Q2FyZHMod2VhdGhlckFyciwgdW5pdHMpIHtcbiAgY29uc3QgbmV4dERheXNBcnIgPSB3ZWF0aGVyQXJyLnNsaWNlKGN1cnJlbnREYXRlQ291bnRlcih3ZWF0aGVyQXJyKSk7XG4gIGNyZWF0ZUNhcmRzKG5leHREYXlzQXJyLCB1bml0cyk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmRzKHdlYXRoZXJBcnIsIHVuaXRzKSB7XG4gIGxldCBjYXJkU3RhcnREYXkgPSAxO1xuICBsZXQgY2FyZEVuZERheSA9IGNhcmRDb3VudCh3ZWF0aGVyQXJyKTtcbiAgbGV0IHN0YXJ0SW5kZXggPSAwO1xuICBsZXQgZW5kSW5kZXggPSBjdXJyZW50RGF0ZUNvdW50ZXIod2VhdGhlckFycik7XG4gIGxldCBlbmRJbmRleENvdW50ID0gZW5kSW5kZXg7XG4gIGNvbnN0IG1haW5SaWdodCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFpbi1yaWdodFwiKTtcbiAgY29uc3QgY2FyZFdyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhcmQtd3JhcHBlclwiKTtcbiAgY2FyZFdyYXBwZXIudGV4dENvbnRlbnQgPSBcIlwiO1xuICB3aGlsZShjYXJkU3RhcnREYXkgPD0gY2FyZEVuZERheSkge1xuICAgIGxldCBzYW1lRGF5QXJyID0gd2VhdGhlckFyci5zbGljZShzdGFydEluZGV4LCBlbmRJbmRleENvdW50KTtcbiAgICBjb25zdCBjYXJkcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY2FyZHMuY2xhc3NMaXN0LmFkZChcImNhcmRzXCIsIGBkYXkke2NhcmRTdGFydERheX1gKTtcbiAgICBjb25zdCBjYWxlbmRhckRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICAgIGNhbGVuZGFyRGF5LmNsYXNzTGlzdC5hZGQoXCJjYXJkLWRheVwiKTtcbiAgICBjYWxlbmRhckRheS50ZXh0Q29udGVudCA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KFwiZW4tdXNcIiwge3dlZWtkYXk6IFwic2hvcnRcIn0pLmZvcm1hdChuZXcgRGF0ZShzYW1lRGF5QXJyWzBdLmR0LnNsaWNlKDAsIDEwKSkpO1xuICAgIGNvbnN0IGhvdXJseUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgaG91cmx5Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJob3VybHktY29udGFpbmVyXCIpO1xuICAgIHNhbWVEYXlBcnIuZm9yRWFjaChkYXkgPT4ge1xuICAgICAgaG91cmx5Q29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUhvdXJseUluZm8oZGF5LCB1bml0cykpO1xuICAgIH0pO1xuICAgIGNhcmRzLmFwcGVuZChjYWxlbmRhckRheSwgaG91cmx5Q29udGFpbmVyKTtcbiAgICBjYXJkV3JhcHBlci5hcHBlbmRDaGlsZChjYXJkcyk7XG4gICAgY2FyZFN0YXJ0RGF5Kys7XG4gICAgc3RhcnRJbmRleCArPSBlbmRJbmRleDtcbiAgICBpZihzdGFydEluZGV4ICE9PSB3ZWF0aGVyQXJyLmxlbmd0aCkgZW5kSW5kZXggPSBjdXJyZW50RGF0ZUNvdW50ZXIod2VhdGhlckFyci5zbGljZShzdGFydEluZGV4KSk7XG4gICAgZW5kSW5kZXhDb3VudCArPSBlbmRJbmRleDtcbiAgfVxuICBtYWluUmlnaHQuYXBwZW5kQ2hpbGQoY2FyZFdyYXBwZXIpOyAgXG59XG5cbi8vQ291bnQgaG93IG1hbnkgZGF5cyB1bnRpbCBuZXh0IGRheSBkYXRhXG5mdW5jdGlvbiBjdXJyZW50RGF0ZUNvdW50ZXIod2VhdGhlckFycikge1xuICBsZXQgY291bnRlciA9IDA7XG4gIGNvbnN0IHRvZGF5c0RhdGUgPSB3ZWF0aGVyQXJyWzBdLmR0LnNsaWNlKDAsIDEwKTtcbiAgd2VhdGhlckFyci5mb3JFYWNoKChkYXRlKSA9PiB7XG4gICAgaWYgKHRvZGF5c0RhdGUgPT09IGRhdGUuZHQuc2xpY2UoMCwgMTApKSBjb3VudGVyKys7XG4gIH0pO1xuICByZXR1cm4gY291bnRlcjtcbn1cblxuLy9Db3VudCBob3cgbWFueSBjYXJkIGNvbnRhaW5lcnMgdG8gbWFrZSBiYXNlZCBvbiBkaWZmZXJlbnQgZGF0ZS5cbmZ1bmN0aW9uIGNhcmRDb3VudCh3ZWF0aGVyQXJyKSB7XG4gIGxldCBkYXlDb3VudCA9IDE7XG4gIGxldCBkYXRlID0gd2VhdGhlckFyclswXS5kdC5zbGljZSgwLCAxMCk7XG4gIHdlYXRoZXJBcnIuZm9yRWFjaChkYXkgPT4ge1xuICAgIGlmKGRheS5kdC5zbGljZSgwLCAxMCkgIT09IGRhdGUpIHtcbiAgICAgIGRheUNvdW50Kys7XG4gICAgICBkYXRlID0gZGF5LmR0LnNsaWNlKDAsIDEwKTtcbiAgICB9XG4gIH0pXG4gIHJldHVybiBkYXlDb3VudDtcbn1cblxuZnVuY3Rpb24gc2ltcGxpZnlUaW1lKHN0cikge1xuICBsZXQgcmVzdWx0ID0gc3RyLnNwbGl0KC86fCAvKS5qb2luKFwiXCIpO1xuICBjb25zdCBwZXJpb2QgPSByZXN1bHQuc2xpY2UocmVzdWx0Lmxlbmd0aCAtIDIpO1xuICAocmVzdWx0Lmxlbmd0aCA+IDcpID8gcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsIDIpIDogcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsIDEpO1xuICByZXR1cm4gcmVzdWx0ICsgcGVyaW9kO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVXZWF0aGVySWNvbihkZXNjcmlwdGlvbikge1xuICBjb25zdCB3ZWF0aGVySWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XG4gIHdlYXRoZXJJY29uLmNsYXNzTGlzdC5hZGQoXCJ3ZWF0aGVyLWljb25cIik7XG4gIHdlYXRoZXJJY29uLnNyYyA9IGBodHRwczovL29wZW53ZWF0aGVybWFwLm9yZy9pbWcvd24vJHtkZXNjcmlwdGlvbn1AMngucG5nYDtcbiAgcmV0dXJuIHdlYXRoZXJJY29uO1xufVxuXG5leHBvcnQgeyB1cGRhdGVMb2NhdGlvbiwgdXBkYXRlV2VhdGhlckRhdGEgfTtcbiIsImltcG9ydCB7IHVwZGF0ZVdlYXRoZXJEYXRhLCB1cGRhdGVMb2NhdGlvbiB9IGZyb20gXCIuL1VJXCI7XG5cbmNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hcIik7XG5jb25zdCBlbnRlckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJidXR0b25cIik7XG5cbmZ1bmN0aW9uIGFuaW1hdGVTZWFyY2hCYXIoKSB7XG4gIGNvbnN0IHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoaW5wdXQpO1xuICBjb25zdCB3aWR0aCA9IHN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJ3aWR0aFwiKTtcbiAgaWYgKHdpZHRoID09PSBcIjBweFwiKSB7XG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJ3aWR0aDogNzUlOyB0cmFuc2l0aW9uOiB3aWR0aCAuNXMgZWFzZTtcIik7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBlbnRlckJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIH0sIDUwMCk7XG4gIH0gZWxzZSB7XG4gICAgaW5wdXQucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIiwgXCJ3aWR0aDogNzUlO1wiKTtcbiAgICBpbnB1dC5zdHlsZS50cmFuc2l0aW9uID0gXCJ3aWR0aCAuNXMgZWFzZVwiO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZW50ZXJCdG4uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH0sIDEwMCk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gc2VhcmNoQmFyKHVzZXJJbnB1dCwgdW5pdHMpIHtcbiAgICBsZXQgY2l0eSA9IHVzZXJJbnB1dFswXTtcbiAgICBsZXQgc3RhdGUgPSB1c2VySW5wdXRbMV07XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgIGBodHRwczovL2FwaS5vcGVud2VhdGhlcm1hcC5vcmcvZ2VvLzEuMC9kaXJlY3Q/cT0ke2NpdHl9LCUyMCR7c3RhdGV9JmxpbWl0PTUmYXBwaWQ9YzQ0MDRiYTdjYzZkMzdlODc2OGU5NjgyZWQwYzcyNTlgLFxuICAgICAgeyBtb2RlOiBcImNvcnNcIiB9XG4gICAgKTtcbiAgICBjb25zdCBsb2NhdGlvbkRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgY29uc29sZS5sb2cobG9jYXRpb25EYXRhKTtcbiAgICBjb252ZXJ0VG9Db3JkaW5hdGVzKGxvY2F0aW9uRGF0YSwgdW5pdHMsIHVzZXJJbnB1dCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNvbnZlcnRUb0NvcmRpbmF0ZXMoZGF0YSwgdW5pdHMsIHVzZXJJbnB1dCkge1xuICAgIGxldCBsYXQgPSBkYXRhWzBdLmxhdDtcbiAgICBsZXQgbG9uID0gZGF0YVswXS5sb247XG4gICAgY29uc3QgY29yZGluYXRlUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgIGBodHRwczovL2FwaS5vcGVud2VhdGhlcm1hcC5vcmcvZGF0YS8yLjUvZm9yZWNhc3Q/bGF0PSR7bGF0fSZsb249JHtsb259JmFwcGlkPWM0NDA0YmE3Y2M2ZDM3ZTg3NjhlOTY4MmVkMGM3MjU5JnVuaXRzPSR7dW5pdHN9YCxcbiAgICAgIHsgbW9kZTogXCJjb3JzXCIgfVxuICAgICk7XG4gICAgY29uc3QgY29yZGluYXRlRGF0YSA9IGF3YWl0IGNvcmRpbmF0ZVJlc3BvbnNlLmpzb24oKTtcbiAgICBjb25zb2xlLmxvZyhjb3JkaW5hdGVEYXRhKTtcbiAgICB1cGRhdGVXZWF0aGVyRGF0YShjb3JkaW5hdGVEYXRhLCBnZXRDdXJyZW50SGlMbyhjb3JkaW5hdGVEYXRhKSwgdW5pdHMpO1xuICAgIHVwZGF0ZUxvY2F0aW9uKHVzZXJJbnB1dCk7XG4gICAgcmV0dXJuIGNvcmRpbmF0ZURhdGE7XG59XG5cbmZ1bmN0aW9uIGdldEN1cnJlbnRIaUxvKHdlYXRoZXJEYXRhKSB7XG4gIGNvbnN0IHdlYXRoZXJBcnIgPSB3ZWF0aGVyRGF0YS5saXN0O1xuICBjb25zdCB0b2RheXNEYXRlID0gY29udmVydFVuaXhUb1VUQyh3ZWF0aGVyRGF0YS5saXN0WzBdLmR0KS5zbGljZSgwLCAxMCk7XG4gIGxldCBsb3cgPSBNYXRoLnJvdW5kKHdlYXRoZXJEYXRhLmxpc3RbMF0ubWFpbi50ZW1wX21pbik7XG4gIGxldCBoaWdoID0gTWF0aC5yb3VuZCh3ZWF0aGVyRGF0YS5saXN0WzBdLm1haW4udGVtcF9tYXgpO1xuICB3ZWF0aGVyQXJyLmZvckVhY2goKGRheSkgPT4ge1xuICAgIGxldCBpZlRvZGF5c0RhdGUgPSBjb252ZXJ0VW5peFRvVVRDKGRheS5kdCkuc2xpY2UoMCwgMTApO1xuICAgIGxldCBtaW5UZW1wID0gTWF0aC5yb3VuZChkYXkubWFpbi50ZW1wX21pbik7XG4gICAgbGV0IG1heFRlbXAgPSBNYXRoLnJvdW5kKGRheS5tYWluLnRlbXBfbWF4KTtcbiAgICBkYXkuZHQgPSBjb252ZXJ0VW5peFRvVVRDKGRheS5kdCk7XG4gICAgaWYgKGlmVG9kYXlzRGF0ZSA9PT0gdG9kYXlzRGF0ZSkge1xuICAgICAgaWYobWluVGVtcCA8PSBsb3cpIGxvdyA9IG1pblRlbXA7XG4gICAgICBpZihtYXhUZW1wID49IGhpZ2gpIGhpZ2ggPSBtYXhUZW1wO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBbbG93LCBoaWdoXTtcbn1cblxuZnVuY3Rpb24gY29udmVydFVuaXhUb1VUQyh1bml4VGltZSkge1xuICBjb25zdCBjb252ZXJ0ZWREYXRlID0gbmV3IERhdGUodW5peFRpbWUgKiAxMDAwKS50b0xvY2FsZURhdGVTdHJpbmcoKTtcbiAgY29uc3QgY29udmVydGVkVGltZSA9IG5ldyBEYXRlKHVuaXhUaW1lICogMTAwMCkudG9Mb2NhbGVUaW1lU3RyaW5nKCk7XG4gIGxldCByZXN1bHQgPSBcIlwiO1xuICAoY29udmVydGVkRGF0ZS5sZW5ndGggPCAxMCkgPyByZXN1bHQgPSAoXCIwXCIgKyBjb252ZXJ0ZWREYXRlKSA6IHJlc3VsdCA9IGNvbnZlcnRlZERhdGU7XG4gIHJldHVybiByZXN1bHQgKz0gYCwgJHtjb252ZXJ0ZWRUaW1lfWA7XG59XG5cbmV4cG9ydCB7IGFuaW1hdGVTZWFyY2hCYXIsIHNlYXJjaEJhciB9O1xuIiwiaW1wb3J0IHsgbW92ZVNsaWRlciB9IGZyb20gXCIuL3NsaWRlclwiO1xuaW1wb3J0IHsgYW5pbWF0ZVNlYXJjaEJhciwgc2VhcmNoQmFyIH0gZnJvbSBcIi4vc2VhcmNoXCI7XG5pbXBvcnQgeyB1cGRhdGVMb2NhdGlvbiB9IGZyb20gXCIuL1VJXCI7XG5cbmxldCB1bml0cyA9IFwiaW1wZXJpYWxcIjtcbmxldCBpbnB1dEFyciA9IFtdO1xuY29uc3Qgb25Mb2FkSW5wdXQgPSBbXCJCcm9va2x5blwiLCBcIk5ldyBZb3JrXCJdO1xuXG53aW5kb3cub25sb2FkID0gKGUpID0+IHtcbiAgc2VhcmNoQmFyKG9uTG9hZElucHV0LCB1bml0cyk7XG59XG5cbmNvbnN0IHNsaWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN3aXRjaFwiKTtcbnNsaWRlcnMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIHVuaXRzID0gbW92ZVNsaWRlcigpO1xuICBpZihpbnB1dEFyci5sZW5ndGggPiAwKSBzZWFyY2hCYXIoaW5wdXRBcnIsIHVuaXRzKTtcbiAgZWxzZSBzZWFyY2hCYXIob25Mb2FkSW5wdXQsIHVuaXRzKVxufSk7XG5cbmNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGlmIChlLnRhcmdldC5pZCA9PT0gXCJzZWFyY2gtaWNvblwiKSBhbmltYXRlU2VhcmNoQmFyKCk7XG4gIGVsc2UgaWYgKGUudGFyZ2V0LmlkID09PSBcInJpZ2h0LWFycm93XCIpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgYW5pbWF0ZVNlYXJjaEJhcigpO1xuICAgIGNvbnN0IHVzZXJJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VhcmNoXCIpLnZhbHVlO1xuICAgIGNvbnN0IGZpbmRDb21tYSA9IHVzZXJJbnB1dC5pbmRleE9mKFwiLFwiKTtcbiAgICBpZih1c2VySW5wdXQuY2hhckF0KGZpbmRDb21tYSArIDEpID09PSBcIiBcIikgaW5wdXRBcnIgPSB1c2VySW5wdXQuc3BsaXQoXCIsIFwiKTtcbiAgICBlbHNlIGlucHV0QXJyID0gdXNlcklucHV0LnNwbGl0KFwiLFwiKTtcbiAgICBjb25zb2xlLmxvZyhpbnB1dEFycik7XG4gICAgaWYoaW5wdXRBcnJbMF0gPT09ICcnKSBhbGVydChcIlBsZWFzZSBlbnRlciBhIENpdHkgYW5kIFN0YXRlL0NvdW50cnksIHNlcGFyYXRlZCBieSBhIGNvbW1hLlwiKTtcbiAgICBlbHNlIGlmKGlucHV0QXJyWzFdID09PSB1bmRlZmluZWQpIGFsZXJ0KFwiTm8gU3RhdGUvQ291bnRyeSB3YXMgaW5jbHVkZWQuIFBsZWFzZSBlbnRlciBhIENpdHkgYW5kIFN0YXRlL0NvdW50cnksIHNlcGFyYXRlZCBieSBhIGNvbW1hLlwiKTtcbiAgICBlbHNlIHtcbiAgICAgIHNlYXJjaEJhcihpbnB1dEFyciwgdW5pdHMpO1xuICAgIH1cbiAgICBmb3JtLnJlc2V0KCk7XG4gIH1cbn0pO1xuIl0sIm5hbWVzIjpbInNsaWRlciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInN0YXRlIiwiZ2V0RWxlbWVudEJ5SWQiLCJjaXR5IiwidXBkYXRlTG9jYXRpb24iLCJ1c2VySW5wdXQiLCJ0ZXh0Q29udGVudCIsInN0eWxlIiwidGV4dFRyYW5zZm9ybSIsImNyZWF0ZUhvdXJseUluZm8iLCJob3VybHlEYXRhIiwidW5pdHMiLCJob3VybHlJbmZvIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImhvdXIiLCJzdHIiLCJyZXN1bHQiLCJzcGxpdCIsImpvaW4iLCJwZXJpb2QiLCJzbGljZSIsImxlbmd0aCIsInNpbXBsaWZ5VGltZSIsImR0Iiwid2VhdGhlckljb24iLCJkZXNjcmlwdGlvbiIsInNyYyIsImNyZWF0ZVdlYXRoZXJJY29uIiwid2VhdGhlciIsImljb24iLCJ0ZW1wQ29udGFpbmVyIiwiaG91cmx5VGVtcCIsIk1hdGgiLCJyb3VuZCIsIm1haW4iLCJ0ZW1wIiwiZGVncmVlcyIsImFwcGVuZCIsImN1cnJlbnREYXRlQ291bnRlciIsIndlYXRoZXJBcnIiLCJjb3VudGVyIiwidG9kYXlzRGF0ZSIsImZvckVhY2giLCJkYXRlIiwiaW5wdXQiLCJlbnRlckJ0biIsImFuaW1hdGVTZWFyY2hCYXIiLCJ3aW5kb3ciLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInNldEF0dHJpYnV0ZSIsInNldFRpbWVvdXQiLCJkaXNwbGF5IiwicmVtb3ZlQXR0cmlidXRlIiwidHJhbnNpdGlvbiIsImFzeW5jIiwic2VhcmNoQmFyIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1vZGUiLCJsb2NhdGlvbkRhdGEiLCJqc29uIiwiY29uc29sZSIsImxvZyIsImRhdGEiLCJsYXQiLCJsb24iLCJjb3JkaW5hdGVSZXNwb25zZSIsImNvcmRpbmF0ZURhdGEiLCJ3ZWF0aGVyRGF0YSIsImhpTG9BcnIiLCJtYWluTGVmdCIsImN1cnJlbnREYXkiLCJsaXN0IiwicmVtb3ZlQ2hpbGQiLCJsYXN0Q2hpbGQiLCJ0b2RheXNDYXJkIiwiaG91cmx5Q29udGFpbmVyIiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJzY3JvbGxCb3giLCJ1cGRhdGVDdXJyZW50RGF5Q2FyZCIsImNhcmRTdGFydERheSIsImNhcmRFbmREYXkiLCJkYXlDb3VudCIsImNhcmRDb3VudCIsInN0YXJ0SW5kZXgiLCJlbmRJbmRleCIsImVuZEluZGV4Q291bnQiLCJtYWluUmlnaHQiLCJjYXJkV3JhcHBlciIsInNhbWVEYXlBcnIiLCJjYXJkcyIsImNhbGVuZGFyRGF5IiwiSW50bCIsIkRhdGVUaW1lRm9ybWF0Iiwid2Vla2RheSIsImZvcm1hdCIsIkRhdGUiLCJjcmVhdGVDYXJkcyIsInVwZGF0ZU5leHREYXlDYXJkcyIsInVwZGF0ZVdlYXRoZXJEYXRhIiwiY29udmVydFVuaXhUb1VUQyIsImxvdyIsInRlbXBfbWluIiwiaGlnaCIsInRlbXBfbWF4IiwiaWZUb2RheXNEYXRlIiwibWluVGVtcCIsIm1heFRlbXAiLCJnZXRDdXJyZW50SGlMbyIsImNvbnZlcnRUb0NvcmRpbmF0ZXMiLCJ1bml4VGltZSIsImNvbnZlcnRlZERhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJjb252ZXJ0ZWRUaW1lIiwidG9Mb2NhbGVUaW1lU3RyaW5nIiwiaW5wdXRBcnIiLCJvbkxvYWRJbnB1dCIsIm9ubG9hZCIsImUiLCJhZGRFdmVudExpc3RlbmVyIiwiYm9keSIsInN3aXRjaFNsaWRlciIsImhpZ2hEZWdyZWUiLCJsb3dEZWdyZWUiLCJtb3ZlU2xpZGVyIiwidGFyZ2V0IiwiaWQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwiZmluZENvbW1hIiwiaW5kZXhPZiIsImNoYXJBdCIsImFsZXJ0IiwidW5kZWZpbmVkIiwicmVzZXQiXSwic291cmNlUm9vdCI6IiJ9